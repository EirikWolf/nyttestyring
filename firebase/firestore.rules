rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ══════════════════════════════════════════════════════════════
    // ÅPEN MODUS – Alle kan lese og skrive uten innlogging.
    // Brukes under utvikling og testing.
    //
    // Når du er klar for tilgangsstyring:
    //   1. Kommenter ut "Åpen modus"-blokken under
    //   2. Fjern kommentarene fra "Sikret modus"-blokken lenger ned
    //   3. Deploy: firebase deploy --only firestore:rules
    // ══════════════════════════════════════════════════════════════

    // ── Åpen modus (aktiv) ──────────────────────────────────────
    match /{document=**} {
      allow read, write: if true;
    }

    // ── Sikret modus (inaktiv – fjern kommentarer for å aktivere) ──
    //
    // function isAuthenticated() {
    //   return request.auth != null;
    // }
    //
    // function hasRole(role) {
    //   return isAuthenticated()
    //     && get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role == role;
    // }
    //
    // function isForumOrAdmin() {
    //   return hasRole('forum') || hasRole('admin');
    // }
    //
    // function isTeamOrAbove() {
    //   return hasRole('team') || isForumOrAdmin();
    // }
    //
    // // ── Tasks (forbedringsforslag) ────────────────────────────
    // match /tasks/{taskId} {
    //   allow read: if isAuthenticated();
    //   allow create: if isAuthenticated();
    //   allow update: if isTeamOrAbove();
    //   allow delete: if isForumOrAdmin();
    // }
    //
    // // ── Team (kapasitet) ─────────────────────────────────────
    // match /team/{memberId} {
    //   allow read: if isAuthenticated();
    //   allow write: if isTeamOrAbove();
    // }
    //
    // // ── Goals (strategiske mål) ──────────────────────────────
    // match /goals/{goalId} {
    //   allow read: if isAuthenticated();
    //   allow write: if isForumOrAdmin();
    // }
    //
    // // ── Config (applikasjon) ─────────────────────────────────
    // match /config/{docId} {
    //   allow read: if isAuthenticated();
    //   allow write: if hasRole('admin');
    // }
    //
    // // ── Sprints (historikk) ──────────────────────────────────
    // match /sprints/{sprintId} {
    //   allow read: if isAuthenticated();
    //   allow write: if isTeamOrAbove();
    // }
    //
    // // ── Users (rolleinfo) ────────────────────────────────────
    // match /users/{userId} {
    //   allow read: if isAuthenticated();
    //   allow write: if hasRole('admin');
    // }
  }
}
